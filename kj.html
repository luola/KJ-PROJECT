<!DOCTYPE html><html><head>  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />  <meta name="viewport" content="width=device-width, initial-scale=1.0">   <title></title>  <link rel="stylesheet" href="http://test.eshicon.org/KJ-PROJECT/css/jquery.mobile-1.4.3.css" />  <script src="http://test.eshicon.org/KJ-PROJECT/js/jquery-2.1.0.js"></script>  <script src="http://test.eshicon.org/KJ-PROJECT/js/jquery.mobile-1.4.3.js"></script>  <script src="https://cdn.socket.io/socket.io-1.0.6.js"></script>  <script src="./html-fileapi-master/js/read-csv.js"></script>    <script>    $(function(){    // 自动打开URL && 文本框焦点设置        // $("#item_self_url").change(function(){        //     $("#item_self_pic_url").focus();        //     window.open($("#item_self_url").val());        // });        // $("#item_other_url").change(function(){        //     $("#item_other_pic_url").focus();        //     window.open($("#item_other_url").val());        // });    //读取pervious页面的锚和after页面的锚                function get_anchor(){  //后退的场合            switch (location.hash)          {            case "#tools":              return "#mission";              break;            case "#message":              return "#mission";              break;            case "#additem_self":              return "#additem_self"; //不翻页              break;            case "#additem_other":              return "#additem_other";  //不翻页              break;            case "#about":              return "#tools";              break;                        case "#input_csv":              return "#input_csv"; //不翻页              break;            default:      //因为mission界面没有anchor,所以default记作#mission,此时不翻页              return "";              break;            }          // };                  };            //手势前进 && 后退          document.addEventListener("touchstart", handleTouchEvent, false);          document.addEventListener("touchend", handleTouchEvent, false);          document.addEventListener("touchmove", handleTouchEvent, false);          var pre = new Array();          var end = new Array();           var delta = new Array();//对于这三个数组,[0]->x,[1]->y          var is_turning = 0;          $("#shift_to_message").on("swipe",function(){ //特别为#mission的导航栏添加滑动翻页功能            $.mobile.changePage("#message",{                transition: "slide",                reverse: false,                changeHash: true              });          });          function turnpage(){            if (delta[0]>10 && Math.abs(delta[1]<10)) {              is_turning = 1;                                          $.mobile.changePage(get_anchor(),{                transition: "slide",                reverse: true,                changeHash: true              });                                        // }else if (delta[0]<-10 && Math.abs(delta[1]<10)) {                          //   is_turning = 1;                          //   $.mobile.changePage(get_anchor(1),{            //     transition: "slide",            //     // reverse: false,            //     changeHash: true            //   });                        };                      };//function turnpage() ending                      function handleTouchEvent(event) {              if (event.touches.length == 1) {                  // var output = document.getElementById("output");                  switch (event.type) {                      case "touchstart":                          is_turning = 0;                          // output.innerHTML = "Touch started (" + event.touches[0].clientX + "," + event.touches[0].clientY + ")";                          pre[0] = event.touches[0].clientX;                          pre[1] = event.touches[0].clientY;                          break;                      case "touchend":                          // output.innerHTML += "Touch ended (" + event.changedTouches[0].clientX + "," + event.changeTouches[0].clientY + ")";                          break;                      case "touchmove":                          // event.preventDefault(); //阻止滚动                          // output.innerHTML += "Touch moved (" + event.changedTouches[0].clientX + "," + event.changedTouches[0].clientY + ")";                          end[0] = event.changedTouches[0].clientX;                          end[1] = event.changedTouches[0].clientY;                          if (is_turning == 0) {     //若页面非正在跳转,则计算delta,翻页                            delta[0]= -(pre[0]-end[0]);                            delta[1] = pre[1]-end[1];                            turnpage();                                              };                          break;                                            }              }          }; //handleTouchEvent() ending              //消息机能          $("#link_start").click(function(){            var iosocket = io.connect('http://157.7.138.169:2333');            iosocket.on('connect', function () {                            $('#incomingChatMessages').append($('<li>连接成功</li><br><hr><br>'));              $('#connect_flag').empty().append("消息(已连接)");                              iosocket.on('message', function(message) {                $('#incomingChatMessages').append($('<li></li>').text(message));              });              iosocket.on('disconnect', function() {                $('#incomingChatMessages').append('<br><hr><br><li>连接异常关闭</li>');                $('#connect_flag').empty().append("消息(连接已断开)");//这里以后加上一个消息计数器              });                        });            $('#outgoingChatMessage').keypress(function(event) {                        if(event.which == 13) {                event.preventDefault();                iosocket.send($("#nickname").val()+":"+$('#outgoingChatMessage').val());                $('#incomingChatMessages').append($('<li></li>').text($("#nickname").val()+":"+$('#outgoingChatMessage').val()));                $('#outgoingChatMessage').val('');              };            });            $("#button_message_send").click(function(){              event.preventDefault();              iosocket.send($("#nickname").val()+":"+$('#outgoingChatMessage').val());              $('#incomingChatMessages').append($('<li></li>').text($("#nickname").val()+":"+$('#outgoingChatMessage').val()));              $('#outgoingChatMessage').val('');            });          }); //$("#link_start").click() ending            $("#button_message_clear").click(function(){              $("#incomingChatMessages").empty();            }); //$("#button_message_clear").click() ending           }); //$(function) ending                </script>  </head><body><div data-role="page" id="mission">  <div data-role="header" data-position="fixed" >    <h1>任务</h1>      <div data-role="button" class="ui-btn-right">        <a href="#tools" data-role="button" data-icon="grid" data-transition="slide">工具</a>      </div>          <div data-role="button" class="ui-btn-left">        <a href="#" data-role="button" data-icon="refresh">刷新</a>      </div>  </div>  <div data-role="content">      <div data-role="collapsible" data-collapsed="false">      <h4>未完成的任务<span class="ui-li-count">33</span></h4>        <ul data-role="listview" data-inset="true" data-filter="true" data-filter-placeholder="在未完成的任务中搜索...">            <li><a href="#">手机                    <p>作者:Mikoto</p>                    <p>摊位:Mikoto's home</p>                    <p>价格:RMB 4000</p>                    <p>代购人:mikoto</p></a></li>            <li><a href="#">Angela                    <p>作者:Mikoto</p>                    <p>摊位:Mikoto's home</p>                    <p>价格:RMB 4000</p>                    <p>代购人:mikoto</p></a></li>            <li><a href="#">Bill                    <p>作者:Mikoto</p>                    <p>摊位:Mikoto's home</p>                    <p>价格:RMB 4000</p>                    <p>代购人:mikoto</p></a></li>                    </ul>                    </div>    <div data-role="collapsible">      <h4>已完成的任务<span class="ui-li-count">3</span></h4>        <ul data-role="listview" data-inset="true" data-filter="true" data-filter-placeholder="在已完成的任务中搜索...">            <li><a href="#">手机                    <p>作者:Mikoto</p>                    <p>摊位:Mikoto's home</p>                    <p>价格:RMB 4000</p>                    <p>代购人:mikoto</p></a></li>            <li><a href="#">Angela                    <p>作者:Mikoto</p>                    <p>摊位:Mikoto's home</p>                    <p>价格:RMB 4000</p>                    <p>代购人:mikoto</p></a></li>            <li><a href="#">Bill                    <p>作者:Mikoto</p>                    <p>摊位:Mikoto's home</p>                    <p>价格:RMB 4000</p>                    <p>代购人:mikoto</p></a></li>                     </ul>      </div>    </div>  <div data-role="footer" data-position="fixed">    <div data-role="navbar" id="shift_to_message">      <ul>        <li><a href="#" data-icon="info" class="ui-state-persist">任务</a></li>        <li><a href="#message" data-icon="star" data-transition="fade" ><span class="ui-li-count">233</span>消息</a></li>      </ul>    </div>  </div></div><div data-role="page" id="message">  <div data-role="header">    <h1 id="connect_flag">消息</h1>   </div>        <div data-role="content">    <input type="button" id="link_start" value="开始与聊天服务器的连接">    <br>    <strong>消息:</strong>&nbsp;<ul id="incomingChatMessages"></ul>    <br>    <label for="outgingChatMessage">发言框</label>    <input type="text" id="outgoingChatMessage">    <label for="nickname">昵称框:以后从本地存储的ID读取,不设置昵称输入</label>    <input type="text" id="nickname" value="">    <input type="button" id="button_message_send" value="发送消息">    <br>    <input type="button" id="button_message_clear" value="清除消息">      </div>  <div data-role="footer" data-position="fixed">    <div data-role="navbar" id="shift_to_mission">      <ul>        <li><a href="#mission" data-icon="info" data-transition="fade">任务</a></li>        <li><a href="#" data-icon="star" class="ui-state-persist">消息</a></li>      </ul>    </div>  </div></div><div data-role="page" id="tools">	<div data-role="header">	   <h1>工具</h1>	    <a href="#mission" data-role="button" data-icon="back" data-transition="slide" data-direction="reverse">返回</a>      <a href="#login" data-role="button" data-icon="minus">退出当前帐号</a>	</div>	<div data-role="content">      <a href="#fiter_setting" data-role="button">过滤设置</a>      <a href="#" data-role="button">战完结算</a>      <a href="#about" data-role="button" data-transition="slide">关于</a>      <br><hr><br>      <a href="#additem_self" data-role="button" data-transition="slide">为自己登录宝物</a>      <a href="#additem_other" data-role="button" data-transition="slide">为他人登录宝物</a>      <a href="#input_csv" data-role="button" data-transition="slide">导入CSV文件</a>      	</div></div><div data-role="page" id="additem_self">  <div data-role="header">    <h1>为自己登录宝物</h1>     <a href="#tools" data-role="button" data-icon="back" data-transition="slide" data-direction="reverse">返回</a>    <a href="#" data-role="button" data-icon="alert">重置</a>  </div>        <div data-role="content">    <form method="get" action="">        <div data-role="fieldcontain">          <label for="name">宝物:</label>          <input type="text" name="text" id="item_self_name" value="" placeholder="宝物的名字">        </div>        <div data-role="fieldcontain">          <label for="name">价格:</label>          <input type="text" name="text" id="item_self_price" value="" placeholder="円/份">        </div>        <div data-role="fieldcontain">          <label for="name">摊位:</label>          <input type="text" name="text" id="item_self_palce" value="" placeholder="宝物的摊位号">        </div>        <div data-role="fieldcontain">          <label for="name">作者:</label>          <input type="text" name="text" id="item_self_author" value="" placeholder="作者的名字">        </div>        <div data-role="fieldcontain">          <label for="name">宝物URL:</label>          <input type="text" name="text" id="item_self_url" value="" placeholder="宝物的URL">        </div>        <div data-role="fieldcontain">          <label for="item_self_copy_number">份数</label>          <input type="range" name="item_self_copy_number" id="item_self_copy_number" value="1" min="1" max="15">        </div>    </form>  </div>  <div data-role="footer">    <div data-role="navbar">      <ul>        <li><a href="#tools" data-icon="arrow-l" class="ui-btn">提交并返回</a></li>      </ul>    </div>  </div></div><div data-role="page" id="additem_other">  <div data-role="header">    <h1>为他人登录宝物</h1>    <a href="#tools" data-role="button" data-icon="back" data-transition="slide" data-direction="reverse">返回</a>    <a href="#" data-role="button" data-icon="alert">重置</a>   </div>        <div data-role="content">    <form method="get" action="">        <div data-role="fieldcontain">          <label for="name">宝物:</label>          <input type="text" name="text" id="item_other_name" value="" placeholder="宝物的名字">        </div>        <div data-role="fieldcontain">          <label for="name">价格:</label>          <input type="text" name="text" id="item_other_price" value="" placeholder="円/份">        </div>        <div data-role="fieldcontain">          <label for="name">摊位:</label>          <input type="text" name="text" id="item_other_place" value="" placeholder="宝物的摊位号">        </div>        <div data-role="fieldcontain">          <label for="name">作者:</label>          <input type="text" name="text" id="item_other_author" value="" placeholder="作者的名字">        </div>        <div data-role="fieldcontain">          <label for="name">宝物URL:</label>          <input type="text" name="text" id="item_other_url" value="" placeholder="宝物的URL">        </div>        <form method="post" action="">          <fieldset data-role="fieldcontain">          <label for="user">代购此宝物的用户</label>            <select name="user" id="user" data-native-menu="false">             <option value="mon">lala</option>             <option value="tue">suica</option>             <option value="wed">baka</option>             <option value="thu">9</option>             <!-- 这里作为动态页面进行更新 -->            </select>          </fieldset>        </form>        <form method="post" action="#">            <div data-role="fieldcontain">              <label for="points">份数</label>              <input type="range" name="points" id="item_other_copy_num" value="1" min="1" max="30">            </div>        </form>        <form method="post" action="#"></form>    </form>  </div>  <div data-role="footer">    <div data-role="navbar">      <ul>        <li><a href="#tools" data-icon="arrow-l" class="ui-btn">提交并返回</a></li>      </ul>    </div>  </div></div><div data-role="page" id="input_csv">  <div data-role="header">    <h1>导入CSV</h1>    <a href="#tools" data-role="button" data-icon="back" data-transition="slide" data-direction="reverse">返回</a>  </div>        <div data-role="content">      <fieldset>        <label for="csvFileInput"> <strong>CSV File:</strong>        </label>        <input type="file" id="csvFileInput" onchange="handleFiles(this.files)"        accept=".csv">      </fieldset>      <center>～上传之前请删除color和header等无用字段,删除末尾空行.以记事本打开，另存为UTF-8编码上传，否则乱码</center>      <center>～仅支持chrome for windows～</center>      <div id="output">      <hr>      <center>这里显示读取结果~debug用</center>      <!-- // <script src="http://test.eshicon.org/KJ-PROJECT/js/read-csv.js"></script> -->      </div>  </div>  <div data-role="footer" data-position="fixed">    <div data-role="navbar">      <ul>        <li><a href="#" data-icon="arrow-l" class="ui-btn">确认导入并返回</a></li>      </ul>    </div>  </div></div><div data-role="page" id="about">  <div data-role="header">   <h1>关于</h1>    <div data-role="button" class="ui-btn-left">      <a href="#tools" data-role="button" data-icon="back" data-transition="slide" data-direction="reverse">返回</a>    </div>    </div>  <div data-role="content">   <center> ver 0.62</center>   <br><hr><br><br><br>   <center>code by</center>   <center> lala && suica</center>   <br><br><br><br><br><hr>   <center>限于版权原因,无法提供webcata图片加载服务</center>  </div></div></body></html>